#三角形绘制
---
学习绘制三角形以前，我们需要了解OpenGL ES中的一些新的概念：坐标转换、投影、摄像机。我们将初步使用GLSL着色器语言，了解OpenGL ES的开发流程。
* ###坐标转换
   1. 默认情况下OpenGL ES中坐标系采用右手定则，坐标系方向如下图：
   ![右手坐标系](/assets/OpenGL ES入门/三角形绘制/右手坐标系.png)

   2. OpenGL ES中一共存在5种空间，每种空间对应一种坐标系。分别是：

      2.1 本地空间\(本地坐标系\)

      2.2 世界空间\(世界坐标系\)

      2.3 观察空间/视觉空间\(观察坐标系\)

      2.4 裁剪空间\(裁剪坐标系\)

      2.5 屏幕空间\(屏幕坐标系\)

   我们在创建物体时，所在空间为本地空间，最终绘制出来的结果在屏幕空间。这样我们就需要把物体坐标转换成最终的屏幕坐标。为了将坐标从一个空间转换到另一个空间，我们需要用到**3个变换矩阵\(模型矩阵、观察矩阵、投影矩阵\)**和一个**视口转换**。下图展示了整个变换过程：

   ![坐标系统转换过程](/assets/OpenGL ES入门/三角形绘制/坐标系统转换过程.png)
   
   ①物体坐标 × 模型矩阵 = 物体在世界坐标系中的坐标(模型矩阵为单位矩阵时，物体坐标系和世界坐标系相同，可忽略。)
   模型矩阵设置：
   ```
   //设置sMMatrix为单位矩阵
   Matrix.setIdentityM(sMMatrix,0);
   
   ```
   ②物体在世界坐标系中的坐标 × 观察矩阵 = 物体在观察坐标系中的坐标
   观察矩阵设置：见**摄像机(观察点)**
   ③物体在观察坐标系中的坐标 × 投影矩阵 = 物体在裁剪坐标系中的坐标
   投影矩阵设置：见**投影**
   ④物体在裁剪坐标系中的坐标，通过视口转换，转换成最终屏幕坐标系中的坐标
   视口转换设置：
   ```
   GLES20.glViewport(0, 0, width, height);
   ```
   注：OpenGL ES2.0及以上跟矩阵相关的操作都在`android.opengl.Matrix`中
   
* ###摄像机(观察点)

* ###投影

   OpenGL ES 中分为两种投影，**正交投影**和**透视投影**，指定了裁剪空间的大小。

   3.1 **正交投影**：适合展示2D画面，没有现实物体效果\(近大远小\)。  
   近平面\(NEAE PLANE\)和远平面\(FAR PLANE\)中间的空间叫做**平截头体**

   ![正交投影](/assets/OpenGL ES入门/三角形绘制/正交投影.png)

   Android中正交投影的设置如下：

   ```
   /**
    * mProjMatrix    正交投影矩阵(OpenGL ES会根据设置参数生成正交投影矩阵，并赋值给mProjMatrix)
    *                用于把观察空间坐标转换成裁剪空间坐标。
    * 0              偏移量，从数组(mProjMatrix)的第几个元素开发赋值。
    * -r, r, -1 , 1  近平面坐标，确定近平面的大小。
    * 3, 5           z轴上近平面距离观察点的距离，z轴上远平面距离观察点的距离。
    */
   Matrix.orthoM(mProjMatrix, 0, 
                    -r, r, -1 , 1 ,
                    3, 5);
   ```

   3.2 **透视投影**：适合展示3D效果，模拟现实物体\(近大远小\)。

   ![透视投影](/assets/OpenGL ES入门/三角形绘制/透视投影.png)

   Android中透视投影的设置如下：

   ```
   /**
    * mProjMatrix 透视投影矩阵(OpenGL ES会根据设置参数生成透视投影矩阵，并赋值给mProjMatrix)
    * 0 偏移量
    * 45f 图中的fov，视角角度
    * r 宽高比
    * 3 近平面
    * 5 远平面
    */              
   Matrix.perspectiveM(mProjMatrix, 0,
                    45f, r, 
                    3, 5)

   /**
    * 此方法为设置平截头体，官方的解释为根据平截头体的6个面生成投影矩阵
    */
   Matrix.frustumM(mProjMatrix,0,
                    -r,r,-1,1,
                    3,5);
   ```


* ###绘制三角形